---
title: 云盘
icon: creative
data: 2022-12-11
category:
  - 编程
  - 挖坑
---

这一部分，主要想看几个开源的云盘项目的代码，如果可以的话，找个看顺眼的把它的前端用最新的技术栈重写一遍。\
依旧是一个...[go to moon](../helloworld/why-the-moon.md)的坑，也许没有实际价值，但，...总是要走吧，至少比学校的那些憨批项目要强。

这种正规点项目的前端代码量基本是要上万了，尤其上面那个竟然20万行？虽然很大一部分是写自己写UI组件和各种调配接口...逻辑的部分也许不多，但...还是有点怕。
等看了再说吧。

### 2022-12-13

#### 现有项目考察 && 初步计划

[cloud-reve](https://github.com/cloudreve)

- gin + react

[file-browser](https://github.com/filebrowser)

- gin + vue

[alist](https://github.com/alist)

- gin + solid

[zfile](https://github.com/zfile)

- spring + vue

先说使用体验，如果是个人使用alist可能是用的最舒服的一个了，因为前端做的优化很多，部署也是一个命令解决。相比其他的一个亮点是，菜单栏做成了悬浮的小图标放在了右下侧，点击后出现弹窗进行相关操作，以此来代替传统的XXX管理系统的时常会显得臃肿的左侧菜单栏。\
如果是需要支持多用户，就是cloud-reve了，也很好，只不过复杂度...我想更先多关注些别的。\
file-browser没怎么用，看着给的示例也还挺好看的。

而zfile...怎么说呢，功能可能是最多的一个，但...缺少造轮子精神吧......前端的组件直接引了element ui 里的，这可能也不算问题，但好多地方看着也是真的缺少打磨。\
而除去使用，在代码组织上，zfile也是...挺让我感觉一言难尽的，前端里建了一大堆的文件和文件夹，有好多只有零星几行，而我看了半天也看不到主页面是哪个文件，结果...直接让我找到一个八百行的单文件组件...在下面。

```path
zfile-vue\src\layouts\file.vue
zfilevue\src\components\file\preview\FileGallery.vue
```

而后端部分...alist和zfile的一个对比，我想找一个对接本地储存源的东西，而...yysy，java的文件夹是真的可怕...。我也不确定这是不是java的原因，毕竟这里添的功能比较多...但一堆controller model一层层的来回套是真的......和用go写的alist相比，下面的路径长度差了都有三倍了。。。

也许java也有很多写的很好的项目..但肯定不是这一个。我想要掌握的...可能也不是语言。

```path
alist\drivers\local\driver.go

zfile\src\main\java\im\zhaojun\zfile\module\storage\model\param\LocalParam.java
```

而，下一步计划的话...我是打算先研究alist的代码了，虽然go语言和这个solid框架我都不熟悉。

- 怎么接的储存源
  - 本来就是个人使用...本地储存就够了，不用接阿里云谷歌云之类的...这些删掉可以吗。
  - 我使用本地储存的时候感觉就只是起了一个http类似的服务，然后加一个简单的地址映射...一定要后端吗，js有可能直接接吗
- 后端都干了什么？
  - 这个是我不熟悉不确定的...以至于我觉得把这里挪走也可以，所以要看...
- 文件在线查看的功能添加
  - 抄！
  - 再一个是图片查看弄成个更好看点的画廊
- 页面设计
  - 抄...我好狠狠的抄...
- 部署，怎么做到一个命令就完成部署的

这样看好烦哦...尤其后端，太不熟了，有没有数据库表设计，接口文档...或者最小实现之类的。

如果能够有像画画那样...从架子开始，到填补小元素的...

要不...起个名字把架子搭起来先？
或者你也要考虑这个项目的核心是什么，什么登录权限，增删改查一类的业务都先一边去，数据有一个基本的浏览与展示就是我需要的，然后就是写前端UI。

#### go项目的考察

go项目结构的瞎bb，如果和上面那个java对比的话，扁平化做的很明显，虽然经常一大列，但好在没有太深的文件夹。（大部分可能本来就不需要

main.go是入口。与之相关的还有cmd这个文件夹，里面有一串启动脚本。\
go.mod和go.sum与项目依赖有关，具体些对应前端，mod像是package json，sum像是lock file。而依赖的具体文件会被放在pkg这个文件夹下。

public是静态文件，前后端合并部署的话要把前端塞这里。\
server就是服务，像java的tomcat一样，但在前后端分离的开发中这个服务大概是专门提供接口的，而接口...也可以用路由集成一下。

drivers是对接各个储存源，也许是这个项目特有...或者像java那边的resources，数据源还有各种各样的东西...\
internal就是...服务的核心了吧...毕竟就剩它了。但我看不动...麻麻的。

两个关键部分。

```path
sqlite alist\alist\data\data.db
router alist\alist\server\router.go
```

#### solid

嗯...大部分都没什么，直接说发现的东西好了。就是，文件名大小写，如果是常规的，每个项目都有的那些router、store、index之类的，就是全小写，而这个项目里特有的，需要查看的，或者说特有的特色部分...自己写的那些文件，就是大写首字母。\
这个项目UI和功能部分的的亮点几乎都在home这个page里，而这个文件夹下的内容也是很多很多...有自己的components和一大串子组件，都写在这里了。而另一个后台页面也挺大，但...比较常规。\
而，直接在src目录下的components和hooks，却没那么多东西，基本都是些背景、零碎的东西。axios甚至被塞到了utils这个文件夹里...可见根本不是重点.jpg\
可能写的都很有特色...吧...但蛮清楚的。或者单纯我见得太少了。

### 2022-12-14

#### 要动手了...

在这里，后端主要是和操作系统和数据库交互，如果是狭义的前端，前端代码是运行在用户的浏览器活客户端里的，不能直接碰到服务端资源...\
用java或者go再或者nodejs的一些服务端框架，哪个都无所谓，都能用，尤其如果只是做个小玩具那就更随便了...能通就行。\
所以...打算用go试一试，做出基本的、简陋的功能出来，然后前端用vue接一下。害...我有预感这一步更多的可能只是熟悉工具，基本做不出成品的，放心做吧。

数据抽象，UI，组合成功能...啊...还是没头绪，做完demo还得再看。
