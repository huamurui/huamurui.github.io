---
icon: discover
date: 2023-01-06
title: 碰碰球
tag:
  - 记录
---

>我在github上翻到了小时候喜欢玩的一个游戏的一部分代码\
……感觉有些，不知道怎么说的感觉。那个游戏在我初中的时候停更，高中的时候关服...\
它所依赖的技术也都过时了\
一门半死不活的语言ActionScript，还有一个被现在大多数浏览器抛弃的平台Adobe Flash\
十年前…\
那时候我还能一玩一整天…\
可是直到它关服我甚至都还不会按F12，也许早点知道的话能看到更多...

所以为什么是碰碰球？因为它简单啊...其实有想过贪吃蛇...但感觉有点麻烦，玩家之间交互麻烦...。主要大概也不是canvas...而是，我想做成一个在浏览器里能玩的，在线的，简单的多人游戏。

要依赖后端去做一个同步。要不要搞“房间”？进入的时候弄个名字选个颜色调调自己球的大小？另一方面，动作更新也是在前端做发给后端，这样才能转发到其他的前端...？传输的时候是不是还要带个token来确认谁是谁...后端到底要存多少东西？...完全没想好。

技术方面，游戏的网络通信，...战网？游戏竟然也有P2P...？

即时的动作、对战类游戏都有它们特化的网络方案，但我不想看...我现在甚至想从“websocket聊天室”这种东西上魔改出一个东西。spring貌似也能做...还有更对口点的socket-io...
但是前端大概...完全和那些框架没关系，顶多两个页面，朝服务器发发请求和数据...

---

嗯...，难搞，那就，哪怕先做成个单人的demo，先想想前端部分。

基本的有，碰撞时改变速度的效果，移动时随时间的加速度，速度上限，加速度固定，边界框框也是个挺重要的东西，是做成相互连接的“瞬移”，还是碰撞体，还是游戏结束的区域，或者交给玩家去选....。球球要有重量吗？这样搞了就要有力，让力成为平衡点..，先不要...。要有大小吗？这只与容易或不容易发生碰撞有关...也许可以加上，反正不难。这些，场地和球球的属性嗯，名字就起Playground和Ball，这部分应该是主要部分\
还有控制输入的方式，键盘，选键位，还有跟随鼠标，再或页面上添一个拖拽的方向盘，直接控制的是加速度，或者说力...还有一个，关于键盘键位，如果是两侧对称的物体，那会有前后控制速度，左右控制方向这样...但是我们是球球，四个键全部搞成速度方向耦合算了，按压着就是有那个方向的加速度，两个不矛盾的同时去按就是给个间位方向，反方向同时按着的话就记成0\
再一个就是，在之后碰撞检测这种事情可能得交给后端或者说服务端..因为要在多端同步。一个挺重要的问题————最少交多少数据可以实现这一部分功能？

碰撞...碰撞的一瞬间发生的应该是速度的变化，包括方向和大小。检测碰撞依赖的是位置。而，想要计算出碰撞之后的变化情况，需要的是碰撞前的速度————方向+大小，也许可以加个重量这个属性但这个先不考虑。

那好吧...我的一个想法就是，平时只发位置，而在检测到碰撞之后，去向前端请求速度信息。————完全没必要，计算还是要全放后端。————只能...一边学不懂的东西一遍处理这些..了吗。用nodejs的后端吧。至少能同一门语言。

算了先做个前端版的。也是为什么我会把这个文章放在这里的原因...吧。

好，整理一下。

- 物理模型，场地和球球
  - Playground
    - 力、加速度
    - 速度上限 & 摩擦力
    - 碰撞检测 & 结果计算
    - 边界
  - Ball
    - 大小
    - 质量
    - 位置
    - 速度

- 输入模式
  - 上下左右
  - 鼠标引导
  - 鼠标，还有移动端的，拖拽的方向盘

先，全在，前端写。突然感觉高中学的物理有点用了..嘿。

对了...我看了的仓库好多都是接近十年前的...原来，真的有好多好多用 IIFE 做模块化的啊...好艰苦...

### 2023-01-07

H5小游戏...的一些游戏引擎。md现在怎么是个游戏就要搞3d那一套...2d就不好玩了吗!?...3d可能是沉浸感...2d还要人..

[Pixi.js](https://github.com/pixijs/pixijs)

[Phaser](https://github.com/photonstorm/phaser)

[CreateJS](https://github.com/createjs)

几年前的好多小仓库...自己写向量对象，自己建物理模型...

如果要找工作也许这不是一个合适的方向...但是好想看...

然后是这个仓库

**[bouncing-balls](https://mtrajk.github.io/bouncing-balls)**

嗯，分析代码。

- 有一个自己实现的向量处理工具，以对象方式呈现-Vector2D
- 然后是ball这个文件里做了Ball这个对象，包括移动、碰撞等物理模型
  - 中学物理.jpg
- 再然后是 bouncing-balls 这个文件里，绑定canvas，动画，事件，添加交互接口...
  - 值得一提的是，这里也有一个，“虚拟画布”的概念。就是，处理物理模型有一个固定的画布大小————宽度单位为 100,长宽比为3:2，就是说，在后台处理运动与碰撞这些事件的时候，处理的数据都是固定的，而渲染出的大小会根据css样式给出的盒子大小进行自动放缩
    - 这很重要，从单机小游戏的各个屏幕适配，到做成前后端分离的多人在线，这都帮了大忙
    - 这个操作我不是第一次见到...之前在做瀑布流处理那些长方形的时候也有类似操作
    - 但我不确定应该把哪一个叫做虚拟哪一个叫做真实，因为后台处理可以看作一种真实，因为这边决定了各个事件的触发；前端渲染也可以看作一种真实，因为它是实实在在渲染出的效果。
      - 懂了，后台的叫做本质，前台的叫做存在。

这个结构其实和我想的不太一样...

>说起来有点离谱..但我感觉这个游戏(apex)，还有吃鸡，有好多地方和一些小游戏其实很像？\
就比如捡装备像是吃食物，射击游戏里会有各种各样的体现，而贪吃蛇里是自己蛇的身体变长。\
还有个元素是“缩圈”，我就想到了碰碰球那个游戏，把别人从台子上挤下去......
